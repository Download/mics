{"version":3,"file":"mics.es.js","sources":["../src/index.js"],"sourcesContent":["var baseclass = class Object{}\r\nvar derive = superclass => ({}[superclass.name || 'Object'] = class extends superclass {})\r\n\r\nexport function mix(...args){\r\n\tvar superclass = !is(args[0]).a('factory') && args.shift() || baseclass\r\n\tvar factory = (is(args[args.length-1]).a('factory') && args.pop()) || derive\r\n\tif (!is(superclass, 'mix')) {\r\n\t\tsuperclass = derive(superclass)\r\n\t\tObject.defineProperties(superclass, {\r\n\t\t\tinterface: {value:getInterface(superclass.prototype), writable:false}\r\n\t\t})\r\n\t}\r\n\tif (args.length) factory = (org => superclass => org(args.reduce((s,m) => m.mixin(s), superclass)))(factory)\r\n\tfunction mixin(superclass) {\r\n\t\tvar result = is(superclass).a(mixin) ? superclass : factory(superclass) \r\n\t\tif (mixin.classes.indexOf(result) == -1) mixin.classes.push(result)\r\n\t\treturn result\r\n\t}\r\n\tObject.defineProperties(mixin, {\r\n\t\tclasses: {value:[], writable:false},\r\n\t\tmixins: {value:args, writable:false},\r\n\t})\r\n\tvar constructor = mixin(superclass)\r\n\treturn Object.defineProperties(constructor, {\r\n\t\tmixin: {value:mixin, writable:false},\r\n\t\tinterface: {get:(x => () => x ? x : x = getInterface(constructor.prototype))()},\r\n\t})\r\n}\r\n\r\nexport default mix\r\n\r\nexport function is(x, type) {\r\n\tfunction a(type) {\r\n\t\tif (typeof type == 'string') {\r\n\t\t\treturn type == 'mixin' ? typeof x == 'function' && !!x.mixin :\r\n\t\t\t       type == 'mix' ? typeof x == 'function' && !!x.interface : \r\n\t\t\t       type == 'factory' ? typeof x == 'function' && x.length == 1 && !x.interface :\r\n\t\t\t\t\t\t typeof x == type;\r\n\t\t}\r\n\t\tif (typeof x == 'object') {\r\n\t\t\tif (x instanceof type) return true\r\n\t\t\tif (type.classes) return type.classes.reduce((f,c) => f || a(c), false)\r\n\t\t}\r\n\t\telse if (typeof x == 'function') {\r\n\t\t\tif (x.mixin && x.mixin.mixins.indexOf(type) !== -1) return true\r\n\t\t\tvar c = x\r\n\t\t\twhile (c !== Object) {\r\n\t\t\t\tif (c === type || c === type.class) return true\r\n\t\t\t\tif (type.mixin && type.mixin.classes && type.mixin.classes.indexOf(c) !== -1) return true\r\n\t\t\t\tc = c.prototype.__proto__.constructor\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false\r\n\t}\r\n\r\n\tfunction as(type) {\r\n\t\tif (a(type)) return true\r\n\t\tvar itf = type.interface || (is(type, 'function') && getInterface(type.prototype))\r\n\t\tvar subject = is(x, 'function') ? x.interface || getInterface(x.prototype) : x\r\n\t\treturn itf && Object.keys(itf).reduce((f, k) => \r\n\t\t\tf && (is(itf[k], 'function') ? is(subject[k], 'function') : k in subject), true\r\n\t\t)\r\n\t}\r\n\r\n\tvar str = x && x.toString() || ''\r\n\treturn type !== undefined ? a(type) : {a, an:a, as}\r\n}\r\n\r\nfunction getPropertyNames(proto) {\r\n\tvar results = []\r\n\twhile (proto !== Object.prototype) {\r\n\t\tObject.getOwnPropertyNames(proto).reduce((arr,k) => arr.indexOf(k) === -1 ? arr.push(k) && arr : arr, results)\r\n\t\tproto = proto.__proto__.constructor.prototype\r\n\t}\r\n\treturn results\r\n}\r\n\r\nfunction getInterface(proto) {\r\n\treturn getPropertyNames(proto).reduce((o,k) => {o[k] = proto[k]; return o}, {})\r\n}\r\n"],"names":["baseclass","derive","superclass","name","mix","args","is","a","shift","factory","length","pop","defineProperties","value","getInterface","prototype","writable","org","reduce","s","m","mixin","result","classes","indexOf","push","constructor","Object","get","x","type","interface","f","c","mixins","class","__proto__","as","itf","subject","keys","k","str","toString","undefined","an","getPropertyNames","proto","results","getOwnPropertyNames","arr","o"],"mappings":"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"}